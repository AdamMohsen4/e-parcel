import{j as e}from"./ui-D-7D7zMz.js";import{r as s}from"./vendor-BhPmHrfx.js";import{c as a,b as i,a0 as r,j as n,a1 as t,N as l,C as c,k as d,r as o,v as h,a as p,L as m,I as x,B as u,A as g}from"./index-DdCeff1O.js";import{r as j,u as v,T as y,a as N,b as f,c as k,d as b,e as w}from"./xlsx---Qwtob_.js";import{C}from"./circle-alert-DuXk93gV.js";import{A as P}from"./arrow-left-o1GZx2S9.js";
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=a("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),S=r("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),E=s.forwardRef((({className:s,variant:a,...r},n)=>e.jsx("div",{ref:n,role:"alert",className:i(S({variant:a}),s),...r})));E.displayName="Alert";const W=s.forwardRef((({className:s,...a},r)=>e.jsx("h5",{ref:r,className:i("mb-1 font-medium leading-none tracking-tight",s),...a})));W.displayName="AlertTitle";const A=s.forwardRef((({className:s,...a},r)=>e.jsx("div",{ref:r,className:i("text-sm [&_p]:leading-relaxed",s),...a})));A.displayName="AlertDescription";const R=()=>{n();const{toast:a}=t(),[i,r]=s.useState("business-info"),[S,R]=s.useState({name:"",vatNumber:"",address:"",city:"",postalCode:"",country:"",contactPerson:"",email:"",phone:""}),[q,$]=s.useState(null),[B,H]=s.useState([]),[T,V]=s.useState([]),[I,L]=s.useState(!1),M=e=>{const{name:s,value:a}=e.target;R((e=>({...e,[s]:a})))},U=async e=>{var s;const i=null==(s=e.target.files)?void 0:s[0];if(i)try{let e;L(!0),$(i),e="text/csv"===i.type?await(async e=>new Promise(((s,a)=>{const i=new FileReader;i.onload=e=>{var i;try{const a=(null==(i=e.target)?void 0:i.result).split("\n").map((e=>e.split(","))),r=a[0],n=["recipientName","recipientAddress","recipientCity","recipientPostalCode","recipientCountry","packageWeight","packageLength","packageWidth","packageHeight"].filter((e=>!r.includes(e)));if(n.length>0)throw new Error(`Missing required columns: ${n.join(", ")}`);const t=a.slice(1).filter((e=>e.length===r.length&&e.some((e=>e.trim())))).map((e=>{const s={};return r.forEach(((a,i)=>{s[a.trim()]=e[i].trim()})),s.packageWeight=parseFloat(s.packageWeight),s.packageLength=parseFloat(s.packageLength),s.packageWidth=parseFloat(s.packageWidth),s.packageHeight=parseFloat(s.packageHeight),s}));s(t)}catch(r){a(r)}},i.onerror=()=>a(new Error("Error reading file")),i.readAsText(e)})))(i):await(async e=>new Promise(((s,a)=>{const i=new FileReader;i.onload=e=>{var i;try{const a=new Uint8Array(null==(i=e.target)?void 0:i.result),r=j(a,{type:"array"}),n=r.Sheets[r.SheetNames[0]],t=v.sheet_to_json(n),l=["recipientName","recipientAddress","recipientCity","recipientPostalCode","recipientCountry","packageWeight","packageLength","packageWidth","packageHeight"],c=Object.keys(t[0]||{}),d=l.filter((e=>!c.includes(e)));if(d.length>0)throw new Error(`Missing required columns: ${d.join(", ")}`);const o=t.map((e=>{const s={};return l.forEach((a=>{s[a]=e[a]})),s.packageWeight=parseFloat(s.packageWeight),s.packageLength=parseFloat(s.packageLength),s.packageWidth=parseFloat(s.packageWidth),s.packageHeight=parseFloat(s.packageHeight),s}));s(o)}catch(r){a(r)}},i.onerror=()=>a(new Error("Error reading file")),i.readAsArrayBuffer(e)})))(i);const s=(e=>{const s=[];return e.forEach(((e,a)=>{e.recipientName||s.push(`Row ${a+1}: Missing recipient name`),e.recipientAddress||s.push(`Row ${a+1}: Missing recipient address`),e.recipientCity||s.push(`Row ${a+1}: Missing recipient city`),e.recipientPostalCode||s.push(`Row ${a+1}: Missing recipient postal code`),e.recipientCountry||s.push(`Row ${a+1}: Missing recipient country`),(isNaN(e.packageWeight)||e.packageWeight<=0)&&s.push(`Row ${a+1}: Invalid package weight`),(isNaN(e.packageLength)||e.packageLength<=0)&&s.push(`Row ${a+1}: Invalid package length`),(isNaN(e.packageWidth)||e.packageWidth<=0)&&s.push(`Row ${a+1}: Invalid package width`),(isNaN(e.packageHeight)||e.packageHeight<=0)&&s.push(`Row ${a+1}: Invalid package height`)})),{valid:0===s.length,errors:s}})(e);s.valid?(V([]),H(e),a({title:"File Processed",description:`Successfully processed ${e.length} shipments.`})):(V(s.errors),a({title:"Validation Errors",description:"Please fix the errors in your file before proceeding.",variant:"destructive"}))}catch(r){a({title:"Error Processing File",description:r instanceof Error?r.message:"An error occurred while processing the file.",variant:"destructive"})}finally{L(!1)}},D=()=>{"business-info"===i?r("upload-data"):"upload-data"===i&&B.length>0&&0===T.length&&r("review")},_=()=>{"upload-data"===i?r("business-info"):"review"===i&&r("upload-data")},Y=async e=>{e.preventDefault(),L(!0);try{B.length,B.reduce(((e,s)=>e+s.packageWeight),0),B.length;await new Promise((e=>setTimeout(e,2e3))),a({title:"Success!",description:"Your high volume shipment request has been submitted."}),R({name:"",vatNumber:"",address:"",city:"",postalCode:"",country:"",contactPerson:"",email:"",phone:""}),$(null),H([]),r("business-info")}catch(s){a({title:"Error",description:"There was an error processing your request. Please try again.",variant:"destructive"})}finally{L(!1)}};return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(l,{}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"High Volume Shipment Booking"}),e.jsxs(E,{className:"mb-8",children:[e.jsx(C,{className:"h-4 w-4"}),e.jsx(W,{children:"Important Information"}),e.jsx(A,{children:"For high volume shipments, please provide your business details and upload a CSV or Excel file containing your shipment data. The file should include columns for recipient name, address, city, postal code, country, and package details."})]}),"business-info"===i&&e.jsxs(c,{children:[e.jsxs(d,{children:[e.jsx(o,{children:"Business Information"}),e.jsx(h,{children:"Please provide your business details for the high volume shipment"})]}),e.jsx(p,{children:e.jsxs("form",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"name",children:"Business Name"}),e.jsx(x,{id:"name",name:"name",value:S.name,onChange:M,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"vatNumber",children:"VAT Number"}),e.jsx(x,{id:"vatNumber",name:"vatNumber",value:S.vatNumber,onChange:M,required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"address",children:"Business Address"}),e.jsx(x,{id:"address",name:"address",value:S.address,onChange:M,required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"city",children:"City"}),e.jsx(x,{id:"city",name:"city",value:S.city,onChange:M,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"postalCode",children:"Postal Code"}),e.jsx(x,{id:"postalCode",name:"postalCode",value:S.postalCode,onChange:M,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"country",children:"Country"}),e.jsx(x,{id:"country",name:"country",value:S.country,onChange:M,required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"contactPerson",children:"Contact Person"}),e.jsx(x,{id:"contactPerson",name:"contactPerson",value:S.contactPerson,onChange:M,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"email",children:"Email"}),e.jsx(x,{id:"email",name:"email",type:"email",value:S.email,onChange:M,required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"phone",children:"Phone Number"}),e.jsx(x,{id:"phone",name:"phone",type:"tel",value:S.phone,onChange:M,required:!0})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(u,{type:"button",onClick:D,children:["Next ",e.jsx(g,{className:"ml-2 h-4 w-4"})]})})]})})]}),"upload-data"===i&&e.jsxs(c,{children:[e.jsxs(d,{children:[e.jsx(o,{children:"Upload Shipment Data"}),e.jsx(h,{children:"Upload a CSV or Excel file containing your shipment data"})]}),e.jsx(p,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(m,{children:"Shipment Data File"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(x,{type:"file",accept:".csv,.xlsx,.xls",onChange:U,className:"hidden",id:"file-upload",disabled:I}),e.jsxs(m,{htmlFor:"file-upload",className:"flex items-center gap-2 px-4 py-2 border rounded-md cursor-pointer hover:bg-accent",children:[e.jsx(F,{className:"h-4 w-4"}),q?q.name:"Upload CSV or Excel file"]}),q&&e.jsx(u,{type:"button",variant:"outline",size:"sm",onClick:()=>{$(null),H([]),V([])},children:"Clear"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Supported formats: CSV, Excel (.xlsx, .xls)"})]}),T.length>0&&e.jsxs(E,{variant:"destructive",children:[e.jsx(C,{className:"h-4 w-4"}),e.jsx(W,{children:"Validation Errors"}),e.jsx(A,{children:e.jsx("ul",{className:"list-disc pl-4",children:T.map(((s,a)=>e.jsx("li",{children:s},a)))})})]}),B.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"font-medium",children:["Preview (",B.length," shipments)"]}),e.jsx("div",{className:"border rounded-md",children:e.jsxs(y,{children:[e.jsx(N,{children:e.jsxs(f,{children:[e.jsx(k,{children:"Recipient"}),e.jsx(k,{children:"Address"}),e.jsx(k,{children:"Weight"})]})}),e.jsx(b,{children:B.slice(0,5).map(((s,a)=>e.jsxs(f,{children:[e.jsx(w,{children:s.recipientName}),e.jsx(w,{children:s.recipientAddress}),e.jsxs(w,{children:[s.packageWeight," kg"]})]},a)))})]})})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(u,{type:"button",variant:"outline",onClick:_,children:[e.jsx(P,{className:"mr-2 h-4 w-4"})," Back"]}),e.jsxs(u,{type:"button",onClick:D,disabled:0===B.length||T.length>0,children:["Next ",e.jsx(g,{className:"ml-2 h-4 w-4"})]})]})]})})]}),"review"===i&&e.jsxs(c,{children:[e.jsxs(d,{children:[e.jsx(o,{children:"Review Your Shipment"}),e.jsx(h,{children:"Please review your business information and shipment data before submitting"})]}),e.jsx(p,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-medium",children:"Business Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(m,{children:"Business Name"}),e.jsx("p",{children:S.name})]}),e.jsxs("div",{children:[e.jsx(m,{children:"VAT Number"}),e.jsx("p",{children:S.vatNumber})]}),e.jsxs("div",{children:[e.jsx(m,{children:"Address"}),e.jsx("p",{children:S.address})]}),e.jsxs("div",{children:[e.jsx(m,{children:"City"}),e.jsx("p",{children:S.city})]}),e.jsxs("div",{children:[e.jsx(m,{children:"Postal Code"}),e.jsx("p",{children:S.postalCode})]}),e.jsxs("div",{children:[e.jsx(m,{children:"Country"}),e.jsx("p",{children:S.country})]}),e.jsxs("div",{children:[e.jsx(m,{children:"Contact Person"}),e.jsx("p",{children:S.contactPerson})]}),e.jsxs("div",{children:[e.jsx(m,{children:"Email"}),e.jsx("p",{children:S.email})]}),e.jsxs("div",{children:[e.jsx(m,{children:"Phone"}),e.jsx("p",{children:S.phone})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-medium",children:"Shipment Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 border rounded-md",children:[e.jsx(m,{children:"Total Packages"}),e.jsx("p",{className:"text-2xl font-bold",children:B.length})]}),e.jsxs("div",{className:"p-4 border rounded-md",children:[e.jsx(m,{children:"Total Weight"}),e.jsxs("p",{className:"text-2xl font-bold",children:[B.reduce(((e,s)=>e+s.packageWeight),0).toFixed(2)," kg"]})]}),e.jsxs("div",{className:"p-4 border rounded-md",children:[e.jsx(m,{children:"Estimated Cost"}),e.jsxs("p",{className:"text-2xl font-bold",children:["€",(10*B.length).toFixed(2)]})]})]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(u,{type:"button",variant:"outline",onClick:_,children:[e.jsx(P,{className:"mr-2 h-4 w-4"})," Back"]}),e.jsx(u,{type:"button",onClick:Y,disabled:I,children:I?"Processing...":"Submit Shipment"})]})]})})]})]})})]})};export{R as default};
