import{c as e,s as t}from"./index-D_ehuLNH.js";
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i=e("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),a=new Map,r=3e5,n=async(e,i,a,r,n,o,d)=>{try{const c="string"==typeof e.pickup?e.pickup:JSON.stringify(e.pickup),l="string"==typeof e.delivery?e.delivery:JSON.stringify(e.delivery),{data:m,error:p}=await t.from("booking").insert({user_id:e.userId,tracking_code:i,carrier_name:e.carrier.name,carrier_price:e.carrier.price,weight:e.weight,dimension_length:e.dimensions.length,dimension_width:e.dimensions.width,dimension_height:e.dimensions.height,pickup_address:c,delivery_address:l,delivery_speed:e.deliverySpeed,include_compliance:e.includeCompliance,label_url:a,pickup_time:r,total_price:n,status:"pending",customer_type:e.customerType||"private",business_name:e.businessName,vat_number:e.vatNumber,cancellation_deadline:d.toISOString(),estimated_delivery:o,payment_method:e.paymentMethod,payment_details:e.paymentDetails?JSON.stringify(e.paymentDetails):null,delivery_date:e.deliveryDate,terms_accepted:e.termsAccepted||!1}).select().maybeSingle();return!p&&(s(e.userId),!0)}catch(c){return!1}},s=e=>{const t=[];for(const i of a.keys())i.includes(e)&&t.push(i);t.forEach((e=>a.delete(e)))},o=async(e,i)=>{try{const n=`bookings-${e}-${i||"all"}`,s=a.get(n);if(s&&Date.now()-s.timestamp<r)return s.data;let o=t.from("booking").select("*").eq("user_id",e).order("created_at",{ascending:!1});i&&(o=o.limit(i));const{data:d,error:c}=await o;return c?[]:(a.set(n,{data:d||[],timestamp:Date.now()}),d||[])}catch(n){return[]}},d=async(e,i)=>{try{const n=`booking-tracking-${i}-${e}`,s=a.get(n);if(s&&Date.now()-s.timestamp<r)return s.data;const{data:o,error:d}=await t.from("booking").select("*").eq("tracking_code",e).eq("user_id",i).maybeSingle();return d?null:(a.set(n,{data:o,timestamp:Date.now()}),o)}catch(n){return null}};export{i as D,o as f,d as g,n as s};
