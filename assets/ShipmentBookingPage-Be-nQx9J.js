import{j as e,K as s,M as a,ae as t,af as r,Y as l,R as i,ag as n,ah as d,ai as o,aj as c,F as m,r as h,ak as x,al as u,am as p,y as g,an as j,ao as v,w as b,ap as y,aq as f,ar as N,as as w,at as k,au as S,av as C,aw as P,ax as D,n as L,O as F,u as _,i as M}from"./vendor-react-c2Vhr46D.js";import{L as I,C as B,a as A,B as E,c as O,g as T,I as R,b as $,d as V,e as H,T as q,f as X,h as G,i as Y,N as J}from"./index-C-QwnRat.js";import{s as z,g as W,a as U}from"./bookingDb-CIB2r9zN.js";import{S as K,a as Z,b as Q,c as ee,d as se}from"./select-b1rtR0Zu.js";import{aA as ae,a0 as te,a1 as re,aB as le,aC as ie,X as ne,a5 as de,ao as oe,a2 as ce,aa as me}from"./vendor-Do_qGNvM.js";import"./vendor-ui-CttiZxwU.js";const he=({value:s,onChange:a})=>e.jsxs("div",{className:"space-y-2",children:[e.jsx(I,{htmlFor:"label-language",className:"text-sm font-medium",children:"Label Language"}),e.jsxs(K,{value:s,onValueChange:a,children:[e.jsx(Z,{id:"label-language",className:"w-full bg-background border-input",children:e.jsx(Q,{placeholder:"Select language"})}),e.jsxs(ee,{children:[e.jsx(se,{value:"en",children:"English"}),e.jsx(se,{value:"fi",children:"Finnish"}),e.jsx(se,{value:"sv",children:"Swedish"}),e.jsx(se,{value:"no",children:"Norwegian"}),e.jsx(se,{value:"da",children:"Danish"})]})]})]}),xe=({bookingResult:i,carrier:n,canCancelBooking:d,labelLanguage:o,setLabelLanguage:c,isGeneratingLabel:m,handleGenerateLabel:h,handleCancelBooking:x,onBookAnother:u})=>e.jsxs(B,{className:"max-w-4xl mx-auto",children:[e.jsx("div",{className:"bg-slate-700 text-white p-3 font-semibold",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(s,{className:"h-5 w-5"}),"Booking Confirmed"]})}),e.jsxs(A,{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"bg-slate-50 p-6 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("div",{className:"bg-slate-200 p-3 rounded-md",children:e.jsx(a,{className:"h-6 w-6 text-slate-700"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-medium",children:"Your shipment is booked!"}),e.jsxs("p",{className:"text-sm text-slate-500",children:["Tracking code: ",(null==i?void 0:i.trackingCode)||(null==i?void 0:i.tracking_code)]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Carrier"}),e.jsx("p",{className:"text-lg font-medium",children:(null==i?void 0:i.carrier_name)||n.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Total Price"}),e.jsxs("p",{className:"text-lg font-medium",children:["€",(null==i?void 0:i.totalPrice)||(null==i?void 0:i.total_price)]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Estimated Delivery"}),e.jsx("p",{className:"text-lg font-medium",children:n.eta})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Status"}),e.jsx("p",{className:"text-lg font-medium text-green-600",children:"Pending"})]})]}),e.jsxs("div",{className:"mt-6 pt-6 border-t",children:[e.jsx("h3",{className:"font-medium mb-4",children:"Shipping Label"}),e.jsxs("div",{className:"flex items-end gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(he,{value:o,onChange:c})}),e.jsxs(E,{variant:"outline",className:"flex items-center gap-2",onClick:h,disabled:m,children:[e.jsx(t,{className:"h-4 w-4"}),m?"Generating...":"Generate & Download Label"]})]})]})]}),d&&e.jsxs("div",{className:"bg-slate-50 p-6 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"bg-slate-200 p-3 rounded-md",children:e.jsx(r,{className:"h-6 w-6 text-slate-700"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Need to cancel?"}),e.jsxs("p",{className:"text-sm text-slate-500",children:["You can cancel this booking until:",e.jsx("span",{className:"font-medium block",children:new Date(i.cancellationDeadline||i.cancellation_deadline).toLocaleString()})]})]})]}),e.jsx(E,{variant:"outline",className:"text-red-600 border-red-200 hover:bg-red-50",onClick:x,children:"Cancel Booking"})]}),e.jsxs("div",{className:"flex justify-between gap-4 pt-4",children:[e.jsx(E,{variant:"outline",asChild:!0,children:e.jsx(l,{to:"/dashboard",children:"View All Shipments"})}),e.jsx(E,{onClick:u,className:"bg-green-600 hover:bg-green-700 text-white",children:"Book Another Shipment"})]})]})]}),ue=["Overview","Package Details","Address","Payment"],pe=i.memo((({currentStep:s})=>e.jsx("div",{className:"flex items-center gap-4 mb-8",children:[1,2,3,4].map((a=>e.jsxs(i.Fragment,{children:[a>1&&e.jsx("div",{className:"flex-1 h-px bg-border"}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full "+(s>=a?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"),children:e.jsx("span",{className:"text-xs font-bold",children:a})}),e.jsx("span",{className:"text-sm mt-1 "+(s>=a?"font-medium":"text-muted-foreground"),children:ue[a-1]})]})]},a)))}))),ge=({className:s,...a})=>e.jsx(n,{className:O("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",s),...a}),je=d,ve=({withHandle:s,className:a,...t})=>e.jsx(o,{className:O("relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",a),...t,children:s&&e.jsx("div",{className:"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border",children:e.jsx(c,{className:"h-2.5 w-2.5"})})}),be=({pickupCountry:s,setPickupCountry:a,pickupPostalCode:t,setPickupPostalCode:r,deliveryCountry:l,setDeliveryCountry:i,deliveryPostalCode:n,setDeliveryPostalCode:d,onSwapLocations:o})=>e.jsxs(ge,{direction:"horizontal",className:"min-h-[200px] rounded-lg border mb-8",children:[e.jsx(je,{defaultSize:50,children:e.jsxs("div",{className:"p-0",children:[e.jsx("div",{className:"bg-slate-700 text-white p-3 font-semibold",children:"Från"}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(I,{htmlFor:"fromCountry",children:"Land"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{id:"fromCountry",className:"w-full h-10 pl-10 pr-4 rounded-md border border-input bg-background appearance-none cursor-pointer",value:s,onChange:e=>a(e.target.value),children:[e.jsx("option",{value:"SE",children:"Sverige"}),e.jsx("option",{value:"FI",children:"Finland"}),e.jsx("option",{value:"NO",children:"Norge"}),e.jsx("option",{value:"DK",children:"Danmark"})]}),e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2",children:T(s)}),e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none",children:e.jsx("svg",{width:"12",height:"8",viewBox:"0 0 12 8",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M1 1.5L6 6.5L11 1.5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(I,{htmlFor:"fromPostal",children:"Postnummer"}),e.jsx(R,{id:"fromPostal",placeholder:"Enter postal code",value:t,onChange:e=>r(e.target.value)}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[t,", Stockholm"]})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",id:"fromCompany",name:"fromType",className:"h-4 w-4 rounded-full border-gray-300 text-primary focus:ring-primary"}),e.jsx(I,{htmlFor:"fromCompany",children:"Företag"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",id:"fromPrivate",name:"fromType",className:"h-4 w-4 rounded-full border-gray-300 text-primary focus:ring-primary",defaultChecked:!0}),e.jsx(I,{htmlFor:"fromPrivate",children:"Privatperson"})]})]})]})]})}),e.jsx(ve,{withHandle:!0,children:e.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 p-2 rounded-full bg-slate-200 hover:bg-slate-300 cursor-pointer z-10",onClick:o,children:e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M7 16L3 12M3 12L7 8M3 12H21M17 8L21 12M21 12L17 16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})}),e.jsx(je,{defaultSize:50,children:e.jsxs("div",{className:"p-0",children:[e.jsx("div",{className:"bg-slate-700 text-white p-3 font-semibold",children:"Till"}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(I,{htmlFor:"toCountry",children:"Land"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{id:"toCountry",className:"w-full h-10 pl-10 pr-4 rounded-md border border-input bg-background appearance-none cursor-pointer",value:l,onChange:e=>i(e.target.value),children:[e.jsx("option",{value:"SE",children:"Sverige"}),e.jsx("option",{value:"FI",children:"Finland"}),e.jsx("option",{value:"NO",children:"Norge"}),e.jsx("option",{value:"DK",children:"Danmark"})]}),e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2",children:T(l)}),e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none",children:e.jsx("svg",{width:"12",height:"8",viewBox:"0 0 12 8",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M1 1.5L6 6.5L11 1.5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(I,{htmlFor:"toPostal",children:"Postnummer"}),e.jsx(R,{id:"toPostal",placeholder:"Enter postal code",value:n,onChange:e=>d(e.target.value)}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[n,", Helsinki"]})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",id:"toCompany",name:"toType",className:"h-4 w-4 rounded-full border-gray-300 text-primary focus:ring-primary"}),e.jsx(I,{htmlFor:"toCompany",children:"Företag"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",id:"toPrivate",name:"toType",className:"h-4 w-4 rounded-full border-gray-300 text-primary focus:ring-primary",defaultChecked:!0}),e.jsx(I,{htmlFor:"toPrivate",children:"Privatperson"})]})]})]})]})})]}),ye=({selectedVolume:s,onVolumeSelect:a})=>(m(),e.jsxs("div",{className:"my-6",children:[e.jsx("h2",{className:"text-2xl font-medium mb-6",children:"Välj paketstorlek"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[{id:"xxs",name:"Småpaket (XXS)",dimensions:"max. 3 x 25 x 35 cm, 2 kg",deliveryTime:"Framme inom 5 arbetsdagar",price:5.9},{id:"s",name:"S paket",dimensions:"max. 11 x 32 x 42 cm, 25 kg",deliveryTime:"Framme inom 1–3 arbetsdagar",price:7.9},{id:"m",name:"M paket",dimensions:"max. 19 x 36 x 60 cm, 25 kg",deliveryTime:"Framme inom 1–3 arbetsdagar",price:9.9},{id:"l",name:"L paket",dimensions:"max. 37 x 36 x 60 cm, 25 kg",deliveryTime:"Framme inom 1–3 arbetsdagar",price:11.9},{id:"xl",name:"XL paket",dimensions:"max. 100 x 60 x 40 cm, 25 kg",deliveryTime:"Framme inom 1–3 arbetsdagar",price:19.9},{id:"xxl",name:"XXL paket",dimensions:"Max 200 cm och längd + omkrets max 300 cm, max 25 kg",deliveryTime:"Framme inom 1–3 arbetsdagar",price:39.9}].map((t=>e.jsxs("div",{className:`\n              relative rounded-lg overflow-hidden cursor-pointer \n              ${s===t.id?"border-2 border-primary shadow-md":"border border-gray-200 hover:border-gray-300 hover:shadow-sm"}\n            `,onClick:()=>a(t.id),children:[t.badge&&e.jsx("div",{className:"absolute top-0 left-0 bg-slate-700 text-white text-xs py-1 px-2 rounded-br-md",children:t.badge}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-medium text-lg",children:t.name}),e.jsx("p",{className:"text-sm text-slate-600 my-2",children:t.dimensions}),e.jsx("p",{className:"text-sm text-slate-600 mb-4",children:t.deliveryTime}),e.jsxs("div",{className:`\n                text-center py-2 px-4 rounded-full font-medium\n                ${s===t.id?"bg-primary text-white":"bg-blue-500 text-white"}\n              `,children:[t.price.toFixed(2)," €"]})]})]},t.id)))}),e.jsxs("div",{className:"mt-8 bg-slate-100 rounded-lg p-6",children:[e.jsx("h3",{className:"font-medium text-lg mb-4",children:"Osäker på paketets storlek?"}),e.jsx("p",{className:"text-slate-600 mb-4",children:"Mät paketets bredd, höjd och djup. Fyll i informationen i fälten nedan för att få en storleksrekommendation för ditt paket."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",placeholder:"Bredd",className:"w-full border border-gray-300 rounded-lg py-2 px-4 pr-12"}),e.jsx("span",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-500",children:"cm"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",placeholder:"Höjd",className:"w-full border border-gray-300 rounded-lg py-2 px-4 pr-12"}),e.jsx("span",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-500",children:"cm"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",placeholder:"Djup",className:"w-full border border-gray-300 rounded-lg py-2 px-4 pr-12"}),e.jsx("span",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-500",children:"cm"})]})]}),e.jsx("button",{className:"mt-4 border border-blue-500 text-blue-500 hover:bg-blue-50 rounded-full py-2 px-6 transition-colors",children:"Visa lämpliga storlekar"})]})]})),fe=({selectedVolume:s,setSelectedVolume:a})=>e.jsxs("div",{className:"border rounded-lg mb-8",children:[e.jsx("div",{className:"bg-slate-700 text-white p-3 font-semibold",children:"Ange sändningsdetaljer"}),e.jsx("div",{className:"p-6",children:e.jsx(ye,{selectedVolume:s,onVolumeSelect:a})})]}),Ne=({senderName:s,setSenderName:a,senderEmail:t,setSenderEmail:r,senderPhone:l,setSenderPhone:i,senderAddress:n,setSenderAddress:d,recipientName:o,setRecipientName:c,recipientEmail:m,setRecipientEmail:h,recipientPhone:x,setRecipientPhone:u,recipientAddress:p,setRecipientAddress:g,pickupCountry:j,pickupPostalCode:v,deliveryCountry:b,deliveryPostalCode:y})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"border rounded-lg mb-8",children:[e.jsx("div",{className:"bg-slate-700 text-white p-3 font-semibold",children:"Avsändare"}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(I,{htmlFor:"senderName",children:"Namn"}),e.jsx(R,{id:"senderName",placeholder:"Avsändarens namn",value:s,onChange:e=>a(e.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(I,{htmlFor:"senderPhone",children:"Telefon"}),e.jsx(R,{id:"senderPhone",placeholder:"Telefonnummer",value:l,onChange:e=>i(e.target.value),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(I,{htmlFor:"senderEmail",children:"E-post"}),e.jsx(R,{id:"senderEmail",type:"email",placeholder:"E-postadress",value:t,onChange:e=>r(e.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(I,{htmlFor:"senderAddress",children:"Adress"}),e.jsx(R,{id:"senderAddress",placeholder:"Gatunamn, husnummer",value:n,onChange:e=>d(e.target.value),required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(I,{htmlFor:"senderPostalCode",children:"Postnummer"}),e.jsx(R,{id:"senderPostalCode",value:v,disabled:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(I,{htmlFor:"senderCountry",children:"Land"}),e.jsx(R,{id:"senderCountry",value:j,disabled:!0})]})]})]})]}),e.jsxs("div",{className:"border rounded-lg mb-8",children:[e.jsx("div",{className:"bg-slate-700 text-white p-3 font-semibold",children:"Mottagare"}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(I,{htmlFor:"recipientName",children:"Namn"}),e.jsx(R,{id:"recipientName",placeholder:"Mottagarens namn",value:o,onChange:e=>c(e.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(I,{htmlFor:"recipientPhone",children:"Telefon"}),e.jsx(R,{id:"recipientPhone",placeholder:"Telefonnummer",value:x,onChange:e=>u(e.target.value),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(I,{htmlFor:"recipientEmail",children:"E-post"}),e.jsx(R,{id:"recipientEmail",type:"email",placeholder:"E-postadress",value:m,onChange:e=>h(e.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(I,{htmlFor:"recipientAddress",children:"Adress"}),e.jsx(R,{id:"recipientAddress",placeholder:"Gatunamn, husnummer",value:p,onChange:e=>g(e.target.value),required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(I,{htmlFor:"recipientPostalCode",children:"Postnummer"}),e.jsx(R,{id:"recipientPostalCode",value:y,disabled:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(I,{htmlFor:"recipientCountry",children:"Land"}),e.jsx(R,{id:"recipientCountry",value:b,disabled:!0})]})]})]})]})]}),we=({senderName:s,senderAddress:a,pickupPostalCode:t,pickupCountry:r,recipientName:l,recipientAddress:i,deliveryPostalCode:n,deliveryCountry:d})=>e.jsxs("div",{className:"bg-slate-50 p-6 rounded-lg border",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Sammanfattning"}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"bg-slate-200 p-3 rounded-md",children:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"text-slate-700",children:[e.jsx("path",{d:"M12 3L20 7.5V16.5L12 21L4 16.5V7.5L12 3Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M12 12L20 7.5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M12 12V21",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M12 12L4 7.5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-8 gap-y-2 flex-1",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Från"}),e.jsx("p",{children:s}),e.jsx("p",{children:t}),e.jsx("p",{children:a||"Stockholm"}),e.jsx("p",{children:$(r)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Till"}),e.jsx("p",{children:l}),e.jsx("p",{children:n}),e.jsx("p",{children:i||"Helsinki"}),e.jsx("p",{children:$(d)})]})]})]})]}),ke=h.forwardRef((({className:s,...a},t)=>e.jsx(x,{className:O("grid gap-2",s),...a,ref:t})));ke.displayName=x.displayName;const Se=h.forwardRef((({className:s,...a},t)=>e.jsx(u,{ref:t,className:O("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),...a,children:e.jsx(p,{className:"flex items-center justify-center",children:e.jsx(g,{className:"h-2.5 w-2.5 fill-current text-current"})})})));Se.displayName=u.displayName;const Ce=h.forwardRef((({className:s,...a},t)=>e.jsx(j,{ref:t,className:O("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...a,children:e.jsx(v,{className:O("flex items-center justify-center text-current"),children:e.jsx(b,{className:"h-4 w-4"})})})));Ce.displayName=j.displayName;const Pe=({totalPrice:s,onPaymentComplete:a,onCancel:t,onSubmit:r})=>{const[l,i]=h.useState("swish"),[n,d]=h.useState(""),[o,c]=h.useState(""),[m,x]=h.useState(""),[u,p]=h.useState(""),[g,j]=h.useState(""),[v,b]=h.useState(""),[P,D]=h.useState(!1),[L,F]=h.useState(!1),_=async e=>{if(e.preventDefault(),L){if("card"===l){if(!(n&&o&&m&&u))return void ae.error("Please fill in all card details");if(16!==n.replace(/\s/g,"").length||!/^\d+$/.test(n.replace(/\s/g,"")))return void ae.error("Please enter a valid card number");if(!/^\d{2}\/\d{2}$/.test(o))return void ae.error("Please enter a valid expiry date (MM/YY)");if(!/^\d{3,4}$/.test(m))return void ae.error("Please enter a valid CVV code")}else if("swish"===l){if(!g)return void ae.error("Please enter your Swish number");if(!/^\d{10}$/.test(g.replace(/\s/g,"")))return void ae.error("Please enter a valid Swish number (10 digits)")}else if("ebanking"===l&&!v)return void ae.error("Please select your bank");D(!0),r({paymentMethod:l,termsAccepted:L,cardNumber:"card"===l?n:void 0,expiryDate:"card"===l?o:void 0,cardholderName:"card"===l?u:void 0,swishNumber:"swish"===l?g:void 0,bankName:"ebanking"===l?v:void 0}),setTimeout((()=>{D(!1),ae.success("Payment processed successfully!"),a()}),2e3)}else ae.error("You must accept the terms and conditions to continue")};return e.jsxs(B,{className:"border rounded-lg mb-8",children:[e.jsxs("div",{className:"bg-slate-700 text-white p-3 font-semibold",children:["Betalning - ",s.toFixed(2),"€"]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Payment methods"}),e.jsx("div",{className:"space-y-2",children:e.jsxs(ke,{defaultValue:"swish",value:l,onValueChange:e=>i(e),className:"gap-3",children:[e.jsxs("div",{className:"flex items-center space-x-2 border p-4 rounded-md "+("swish"===l?"border-primary":"border-gray-200"),children:[e.jsx(Se,{value:"swish",id:"swish"}),e.jsxs(I,{htmlFor:"swish",className:"flex items-center gap-2 cursor-pointer flex-1",children:[e.jsx(y,{className:"h-5 w-5 text-blue-600"}),e.jsx("span",{children:"Swish"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 border p-4 rounded-md "+("ebanking"===l?"border-primary":"border-gray-200"),children:[e.jsx(Se,{value:"ebanking",id:"ebanking"}),e.jsxs(I,{htmlFor:"ebanking",className:"flex items-center gap-2 cursor-pointer flex-1",children:[e.jsx(f,{className:"h-5 w-5 text-blue-600"}),e.jsx("span",{children:"eBanking"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 border p-4 rounded-md "+("card"===l?"border-primary":"border-gray-200"),children:[e.jsx(Se,{value:"card",id:"card"}),e.jsxs(I,{htmlFor:"card",className:"flex items-center gap-2 cursor-pointer flex-1",children:[e.jsx(N,{className:"h-5 w-5 text-blue-600"}),e.jsx("span",{children:"Card payment"})]})]})]})})]}),e.jsxs("form",{onSubmit:_,className:"space-y-4",children:["swish"===l&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(I,{htmlFor:"swishNumber",children:"Swish Number"}),e.jsxs("div",{className:"relative",children:[e.jsx(y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 h-4 w-4"}),e.jsx(R,{id:"swishNumber",type:"tel",value:g,onChange:e=>j(e.target.value.replace(/\D/g,"")),placeholder:"07X XXX XX XX",className:"pl-10",maxLength:10})]})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-md flex items-start gap-3 text-sm text-blue-700",children:[e.jsx(w,{className:"h-5 w-5 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Swish Information"}),e.jsx("p",{children:"You will receive a Swish payment request to your mobile phone. Accept the payment in your Swish app to complete the transaction."})]})]})]}),"ebanking"===l&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(I,{htmlFor:"bankSelection",children:"Select Your Bank"}),e.jsx(ke,{value:v,onValueChange:b,className:"grid grid-cols-2 gap-3",children:["Nordea","SEB","Handelsbanken","Swedbank","Danske Bank","Länsförsäkringar"].map((s=>e.jsxs("div",{className:"flex items-center space-x-2 border p-3 rounded-md "+(v===s?"border-primary":"border-gray-200"),children:[e.jsx(Se,{value:s,id:`bank-${s}`}),e.jsx(I,{htmlFor:`bank-${s}`,className:"cursor-pointer",children:s})]},s)))})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-md flex items-start gap-3 text-sm text-blue-700",children:[e.jsx(k,{className:"h-5 w-5 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Bank Information"}),e.jsx("p",{children:"You will be redirected to your bank's website to complete the payment."})]})]})]}),"card"===l&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(I,{htmlFor:"cardNumber",children:"Card Number"}),e.jsxs("div",{className:"relative",children:[e.jsx(N,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 h-4 w-4"}),e.jsx(R,{id:"cardNumber",value:n,onChange:e=>d((e=>{const s=e.replace(/\s+/g,"").replace(/[^0-9]/gi,"").match(/\d{4,16}/g),a=s&&s[0]||"",t=[];for(let r=0,l=a.length;r<l;r+=4)t.push(a.substring(r,r+4));return t.length?t.join(" "):e})(e.target.value)),placeholder:"4111 1111 1111 1111",className:"pl-10",maxLength:19})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(I,{htmlFor:"expiryDate",children:"Expiry Date"}),e.jsxs("div",{className:"relative",children:[e.jsx(S,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 h-4 w-4"}),e.jsx(R,{id:"expiryDate",value:o,onChange:e=>c((e=>{const s=e.replace(/\s+/g,"").replace(/[^0-9]/gi,"");return s.length>=2?`${s.substring(0,2)}/${s.substring(2,4)}`:s})(e.target.value)),placeholder:"MM/YY",className:"pl-10",maxLength:5})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(I,{htmlFor:"cvv",children:"CVV"}),e.jsxs("div",{className:"relative",children:[e.jsx(C,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 h-4 w-4"}),e.jsx(R,{id:"cvv",value:m,onChange:e=>x(e.target.value.replace(/\D/g,"")),placeholder:"123",className:"pl-10",maxLength:4})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(I,{htmlFor:"cardholderName",children:"Cardholder Name"}),e.jsx(R,{id:"cardholderName",value:u,onChange:e=>p(e.target.value),placeholder:"John Doe"})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-md flex items-start gap-3 text-sm text-blue-700",children:[e.jsx(C,{className:"h-5 w-5 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Secure Payment"}),e.jsx("p",{children:"All payment information is encrypted and secure."})]})]})]}),e.jsxs("div",{className:"mt-6 flex items-start gap-2",children:[e.jsx(Ce,{id:"terms",checked:L,onCheckedChange:e=>F(e)}),e.jsx("div",{className:"grid gap-1.5 leading-none",children:e.jsxs(I,{htmlFor:"terms",className:"text-sm text-muted-foreground",children:["I accept the "," ",e.jsx("a",{href:"#",className:"text-blue-600 hover:underline",children:"terms and conditions"})," and I have read the "," ",e.jsx("a",{href:"#",className:"text-blue-600 hover:underline",children:"privacy statement"})]})})]}),e.jsx("div",{className:"mt-4 space-y-2 text-sm text-gray-600",children:e.jsxs("ul",{className:"list-disc ml-5 space-y-1",children:[e.jsx("li",{children:"Domestic parcel services"}),e.jsx("li",{children:"Letter services and international parcels"}),e.jsx("li",{children:"General delivery conditions"})]})}),e.jsxs("div",{className:"flex justify-between gap-4 mt-6",children:[e.jsx(E,{type:"button",variant:"outline",onClick:t,children:"Previous"}),e.jsx(E,{type:"submit",disabled:P,className:"bg-green-600 hover:bg-green-700 text-white min-w-[7rem]",onClick:_,children:P?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("svg",{className:"animate-spin h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):`Pay (${s.toFixed(2)}€)`})]})]})]})]})};function De({className:s,classNames:a,showOutsideDays:t=!0,...r}){return e.jsx(P,{showOutsideDays:t,classNames:{months:"flex flex-col sm:flex-row gap-6 w-full min-h-[500px] bg-prima ",month:"space-y-4 shadow-md rounded-lg overflow-hidden",caption:"flex justify-between items-center py-3 px-5 bg-slate-50 border-b",caption_label:"text-base font-bold ",nav:"flex items-center space-x-2",nav_button:O(V({variant:"outline"}),"h-10 w-10 bg-white text-slate-600 border-slate-200 rounded-full hover:bg-slate-100 transition-all"),nav_button_previous:"",nav_button_next:"",table:"w-full border-collapse table-fixed",head_row:"bg-primary",head_cell:"text-slate-500 font-semibold text-xs uppercase py-3 text-white",row:"table-row border-b last:border-b-0 border-primary",cell:"table-cell h-20 text-center text-sm relative",day:O(V({variant:"ghost"}),"h-16 w-16 p-0 font-medium rounded-md  hover:bg-slate-100 hover:text-slate-900 transition-all mx-auto"),day_range_end:"bg-primary text-white rounded-r-md",day_selected:"bg-primary text-white font-bold hover:bg-primary-dark",day_today:"border border-primary text-primary font-semibold",day_outside:"text-slate-400 opacity-60",day_disabled:"text-slate-300 opacity-50 cursor-not-allowed",day_range_middle:"bg-slate-800 text-slate-700",day_hidden:"invisible",...a},components:{IconLeft:s=>e.jsx(D,{...s,className:"h-6 w-6 text-slate-600"}),IconRight:s=>e.jsx(L,{...s,className:"h-6 w-6 text-slate-600"})},...r})}De.displayName="CalendarPrice";const Le=({date:s,currentMonth:a,pricingData:t,dateRange:r,onSelect:l,isSelected:i=!1})=>{const n=((e,s)=>e.find((e=>ne(e.date,s))))(t,s),d=ie(s,r),o=d&&n&&n.basePrice>0&&"low"===n.loadFactor;let c="h-16 w-full p-0 font-normal flex flex-col items-center justify-center rounded hover:bg-gray-50 relative cursor-default";if(de(s,a))if(d&&n){const e={low:"bg-green-100 hover:bg-green-200 border-green-200 text-black",medium:"bg-yellow-50 hover:bg-yellow-100 border-yellow-200 text-yellow-800",high:"bg-red-50 hover:bg-red-100 border-red-200 text-red-800"};n.basePrice>0&&"low"==n.loadFactor?c+=` ${e[n.loadFactor]} border-b-2 cursor-pointer`:c+=" text-gray-400"}else c+=" text-gray-400";else c+=" text-gray-300 opacity-50";i&&"low"==n.loadFactor&&(c+=" ring-2 ring-green-600");const m=n&&n.basePrice>0?"text-xs font-normal":"text-sm";return e.jsxs("div",{className:c,onClick:e=>{o&&l&&(e.preventDefault(),e.stopPropagation(),l(s))},children:[e.jsx("span",{className:m,children:oe(s,"d")}),d&&n&&n.basePrice>0&&e.jsx("span",{className:"text-[11px] font-medium"}),d&&n&&n.basePrice>0&&"low"===n.loadFactor&&e.jsx("div",{className:"absolute -bottom-1 left-1/2 transform -translate-x-1/2"})]})},Fe=({currentMonth:s,setCurrentMonth:a,pricingData:t,isLoading:r,dateRange:l,onDateSelect:i,selectedDate:n})=>{const{t:d}=m();return e.jsxs(B,{className:"h-full bg-white border border-gray-100 shadow-sm",children:[e.jsxs(H,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("h4",{className:"text-sm font-medium"})}),e.jsx(q,{children:e.jsxs(X,{children:[e.jsx(G,{asChild:!0,children:e.jsx(E,{variant:"ghost",size:"icon",className:"h-8 w-8 text-gray-500",children:e.jsx(F,{className:"h-4 w-4"})})}),e.jsx(Y,{className:"max-w-xs",children:e.jsx("p",{children:d("shipping.priceCalendarInfo","Shipping rates vary based on demand.")})})]})})]}),e.jsx(A,{children:r?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-primary"})}):e.jsx("div",{className:"flex justify-center items-center transform origin-center pb-8",children:e.jsx(De,{mode:"single",month:s,onMonthChange:a,selected:n||void 0,onSelect:e=>e&&(null==i?void 0:i(e)),className:"mx-auto rounded-md border-0 w-full max-w-[90%] pointer-events-auto flex flex-col items-center",showOutsideDays:!0,components:{Day:({date:a,...r})=>e.jsx("div",{...r,children:a&&e.jsx(Le,{date:a,currentMonth:s,pricingData:t,dateRange:l,onSelect:i,isSelected:!(!n||!a)&&n.getTime()===a.getTime()})})}})})})]})},_e=({selectedDeliveryOption:s,onOptionSelect:a,showPriceCalendar:t,currentMonth:r,setCurrentMonth:l,pricingData:i,isCalendarLoading:n,dateRange:d,selectedDeliveryDate:o,onDateSelect:c})=>e.jsxs("div",{className:"mt-8 border rounded-lg shadow-sm",children:[e.jsx("div",{className:"bg-slate-700 text-white p-3 font-semibold",children:"Select Delivery Option"}),e.jsxs("div",{className:"p-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(E,{onClick:()=>a("fast"),type:"button",className:"h-20 text-left p-4 rounded-lg border transition-all duration-200 \n            "+("fast"===s?" text-white":"bg-white border-gray-300 text-gray-700 hover:bg-gray-100"),children:e.jsxs("div",{className:"flex flex-col items-start space-y-1",children:[e.jsx("span",{className:"font-medium text-base",children:"Fast Delivery"}),e.jsx("span",{className:"text-sm text-black-600",children:"Arrives in 2-4 business days"})]})}),e.jsx(E,{onClick:()=>a("cheap"),type:"button",className:"h-20 text-left p-4 rounded-lg border transition-all duration-200 \n            "+("cheap"===s?"text-white":"bg-white border-gray-300 text-gray-700 hover:bg-gray-100"),children:e.jsxs("div",{className:"flex flex-col items-start space-y-1",children:[e.jsx("span",{className:"font-medium text-base",children:"Cheap Delivery"}),e.jsx("span",{className:"text-sm text-black-600",children:"Save money by selecting a specific date"})]})})]}),t&&e.jsxs("div",{className:"px-6 pb-6",children:[e.jsxs("div",{className:"mt-4 mb-2 flex items-center",children:[e.jsx(S,{className:"h-5 w-5 mr-2 text-blue-500"}),e.jsx("h3",{className:"font-medium",children:"Select delivery date to get the best price"})]}),e.jsx("div",{className:"border rounded-lg shadow-sm bg-white",children:e.jsx(Fe,{currentMonth:r,setCurrentMonth:l,pricingData:i,isLoading:n,dateRange:d,onDateSelect:c,selectedDate:o})}),o&&e.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-md",children:e.jsxs("p",{className:"text-blue-800",children:[e.jsx("span",{className:"font-medium",children:"Delivery date selected: "}),o.toLocaleDateString()]})})]})]}),Me=()=>{const{user:e}=_(),[s,a]=h.useState(null),[t,r]=h.useState(!1),[l,i]=h.useState(!1),[n,d]=h.useState(!1),[o,c]=h.useState("en"),[m,x]=h.useState(!1);return h.useEffect((()=>{(async()=>{if(e){const s=localStorage.getItem("lastBooking");if(s){const{trackingCode:t,timestamp:l}=JSON.parse(s),n=await W(t,e.id);if(n){a(n),r(!0);const e=new Date(n.cancellation_deadline);new Date<e?i(!0):(localStorage.removeItem("lastBooking"),i(!1))}else localStorage.removeItem("lastBooking")}}})()}),[e]),{bookingResult:s,bookingConfirmed:t,canCancelBooking:l,isBooking:n,labelLanguage:o,isGeneratingLabel:m,setLabelLanguage:c,setIsGeneratingLabel:x,handleBookNow:async s=>{var t;if(e){if(!n){d(!0);try{const e=await(async e=>{try{if(!e.pickup||!e.delivery||!e.userId)return{success:!1,message:"Required fields are missing"};const s=`SHIP-${Date.now().toString(36)}${Math.random().toString(36).substring(2,6)}`.toUpperCase(),a=(Date.now().toString(36).substring(0,4),`EP${Math.floor(1e7*Math.random()).toString().padStart(7,"0")}FI`),t=((e,s=0)=>{const a=s>0?e*(1-s/100):e;return Math.round(100*a)/100})(e.carrier.price),r=`https://api.shipping.com/labels/${a}`,l=new Date;l.setHours(l.getHours()+2);const i=new Date;if(i.setHours(i.getHours()+24),!(await z(e,a,r,l.toISOString(),t,i)))return{success:!1,message:"Failed to save booking to database"};const n={id:s,tracking_code:a,user_id:e.userId,status:"pending",pickup_address:"string"==typeof e.pickup?e.pickup:JSON.stringify(e.pickup),delivery_address:"string"==typeof e.delivery?e.delivery:JSON.stringify(e.delivery),weight:e.weight,dimension_length:e.dimensions.length,dimension_width:e.dimensions.width,dimension_height:e.dimensions.height,carrier_name:e.carrier.name||"E-Parcel Nordic",carrier_price:e.carrier.price,total_price:t,cancellation_deadline:i.toISOString(),can_be_cancelled:"yes",created_at:(new Date).toISOString(),customer_type:e.customerType||"private",pooling_enabled:e.poolingEnabled?"yes":"no",delivery_date:e.deliveryDate?new Date(e.deliveryDate).toISOString():null,payment_method:e.paymentMethod,payment_details:e.paymentDetails?JSON.stringify(e.paymentDetails):null,terms_accepted:e.termsAccepted?"yes":"no",label_url:r,pickup_time:l.toISOString()},d=JSON.parse(localStorage.getItem(`bookings_${e.userId}`)||"[]");return d.push(n),localStorage.setItem(`bookings_${e.userId}`,JSON.stringify(d)),{success:!0,message:"Shipment booked successfully",shipmentId:s,trackingCode:a,totalPrice:t,cancellationDeadline:i.toISOString()}}catch(s){return{success:!1,message:"Failed to book shipment"}}})(s);e.success?(a(e),r(!0),i(!0),localStorage.setItem("lastBooking",JSON.stringify({trackingCode:e.trackingCode,timestamp:(new Date).toISOString()})),ae.success(`Your shipment has been booked with tracking code: ${e.trackingCode}`)):ae.error(e.message||"There was a problem with your booking.")}catch(l){ae.error("An unexpected error occurred during booking.")}finally{d(!1)}}}else null==(t=document.querySelector("button.cl-userButtonTrigger"))||t.click()},handleCancelBooking:async()=>{if(!(null==s?void 0:s.trackingCode)&&!(null==s?void 0:s.tracking_code))return;const t=s.trackingCode||s.tracking_code;if(t&&(null==e?void 0:e.id))try{const s=await(async(e,s)=>{try{const a=JSON.parse(localStorage.getItem(`bookings_${s}`)||"[]"),t=a.findIndex((s=>s.tracking_code===e));return a[t].status="cancelled",a[t].can_be_cancelled=!1,localStorage.setItem(`bookings_${s}`,JSON.stringify(a)),!0}catch(a){return!1}})(t,e.id);s?(r(!1),a(null),i(!1),localStorage.removeItem("lastBooking"),ae.success("Your booking has been successfully cancelled.")):ae.error("Unable to cancel booking. Please try again or contact support.")}catch(l){ae.error("An unexpected error occurred.")}},resetBooking:()=>{r(!1),a(null),localStorage.removeItem("lastBooking")}}},Ie=({customerType:s})=>{const{isSignedIn:a,user:t}=_(),r=M(),[l,i]=h.useState("5"),[n,d]=h.useState("20"),[o,c]=h.useState("15"),[m,x]=h.useState("10"),[u,p]=h.useState("Stockholm, SE"),[g,j]=h.useState("112 23"),[v,b]=h.useState("Helsinki, FI"),[y,f]=h.useState("00341"),[N,w]=h.useState(s||"private"),[k,S]=h.useState(null),[C,P]=h.useState("SE"),[D,L]=h.useState("FI"),[F,I]=h.useState(1),[B,A]=h.useState("m"),[O,T]=h.useState(null),[R,$]=h.useState(""),[V,H]=h.useState(""),[q,X]=h.useState(""),[G,Y]=h.useState(""),[z,W]=h.useState(""),[K,Z]=h.useState(""),[Q,ee]=h.useState(""),[se,ae]=h.useState(""),{bookingResult:ne,bookingConfirmed:de,canCancelBooking:oe,isBooking:he,labelLanguage:ue,isGeneratingLabel:ge,setLabelLanguage:je,setIsGeneratingLabel:ve,handleBookNow:ye,handleCancelBooking:ke,resetBooking:Se}=Me(),{showPriceCalendar:Ce,setShowPriceCalendar:De,currentMonth:Le,setCurrentMonth:Fe,pricingData:Ie,isCalendarLoading:Be,selectedDeliveryDate:Ae,dateRange:Ee,handleDeliveryDateSelect:Oe}=(()=>{const[e,s]=h.useState(!1),[a,t]=h.useState(new Date),[r,l]=h.useState([]),[i,n]=h.useState(!1),[d,o]=h.useState(null),c=ce(new Date),m={start:c,end:me(c,3)};h.useEffect((()=>{e&&x()}),[e,a]);const x=()=>{n(!0),setTimeout((()=>{const e=((e,s)=>{const a=te(e),t=re(e);return le({start:a,end:t}).map((e=>{if(ie(e,s)){const s=e.getDay();let a=0===s||6===s?{low:.1,medium:.3,high:.6}:{low:.5,medium:.3,high:.2};const t=Math.random();let r;r=t<a.low?"low":t<a.low+a.medium?"medium":"high";const l={low:8.99,medium:10.99,high:13.99},i={low:{min:10,max:50},medium:{min:51,max:150},high:{min:151,max:300}},n=Math.floor(Math.random()*(i[r].max-i[r].min+1)+i[r].min);return{date:e,loadFactor:r,basePrice:l[r],estimatedOrders:n}}return{date:e,loadFactor:"medium",basePrice:0,estimatedOrders:0}}))})(a,m);l(e),n(!1)}),600)};return{showPriceCalendar:e,setShowPriceCalendar:s,currentMonth:a,setCurrentMonth:t,pricingData:r,isCalendarLoading:i,selectedDeliveryDate:d,setSelectedDeliveryDate:o,dateRange:m,handleDeliveryDateSelect:e=>{o(e)}}})(),Te=()=>{switch(B){case"xxs":return 5.9;case"s":return 7.9;case"m":default:return 9.9;case"l":return 11.9;case"xl":return 19.9;case"xxl":return 39.9}},Re={id:1,name:"",price:Te(),eta:"",icon:""},$e=async()=>{var e;if(F<4)return void Ve();if(!a||!t)return void(null==(e=document.querySelector("button.cl-userButtonTrigger"))||e.click());const s={weight:l,dimensions:{length:n,width:o,height:m},pickup:{name:R,address:G,postalCode:g,city:"Stockholm",country:C,phone:q,email:V},delivery:{name:z,address:se,postalCode:y,city:"Helsinki",country:D,phone:Q,email:K},carrier:{name:Re.name,price:Re.price},userId:t.id,customerType:N||"private",pickupSlotId:"slot-1",poolingEnabled:"cheap"===k,deliveryDate:Ae?Ae.toISOString():void 0,paymentMethod:null==O?void 0:O.paymentMethod,termsAccepted:null==O?void 0:O.termsAccepted};await ye(s)},Ve=()=>{I(F+1)},He=()=>{I(F-1)};return de?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(J,{}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx(xe,{bookingResult:ne,carrier:Re,canCancelBooking:oe,labelLanguage:ue,setLabelLanguage:je,isGeneratingLabel:ge,handleGenerateLabel:async()=>{if(!ne)return;const e=ne.trackingCode||ne.tracking_code,s=ne.shipmentId||"SHIP-"+Math.floor(1e6*Math.random());if(e){ve(!0);try{const a=`${n}x${o}x${m} cm`,t=await U({shipmentId:s,carrierName:ne.carrier_name||"E-Parcel",trackingCode:e,senderAddress:u,recipientAddress:v,packageDetails:{weight:l,dimensions:a},language:ue});t.success&&t.labelUrl&&window.open(t.labelUrl,"_blank")}catch(a){}finally{ve(!1)}}},handleCancelBooking:ke,onBookAnother:()=>{Se(),r("/shipment")}})})]}):e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(J,{}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-5xl mx-auto",children:[e.jsx(pe,{currentStep:F}),e.jsxs("form",{onSubmit:e=>{e.preventDefault(),F<3?Ve():$e()},children:[1===F&&e.jsxs("div",{children:[e.jsx(be,{pickupCountry:C,setPickupCountry:P,pickupPostalCode:g,setPickupPostalCode:j,deliveryCountry:D,setDeliveryCountry:L,deliveryPostalCode:y,setDeliveryPostalCode:f,onSwapLocations:()=>{const e=u,s=g,a=C;p(v),j(y),P(D),b(e),f(s),L(a)}}),e.jsx(_e,{selectedDeliveryOption:k,onOptionSelect:e=>{S(e),"fast"===e?(De(!1),setSelectedDeliveryDate(null)):"cheap"===e&&De(!0)},showPriceCalendar:Ce,currentMonth:Le,setCurrentMonth:Fe,pricingData:Ie,isCalendarLoading:Be,dateRange:Ee,selectedDeliveryDate:Ae,onDateSelect:Oe}),e.jsx("div",{className:"flex justify-end mt-6",children:e.jsx(E,{type:"button",onClick:Ve,className:"bg-green-600 hover:bg-green-700 text-white",disabled:"cheap"===k&&!Ae,children:"Continue"})})]}),2===F&&e.jsxs("div",{children:[e.jsx(fe,{selectedVolume:B,setSelectedVolume:A}),e.jsxs("div",{className:"flex justify-between gap-4 mt-6",children:[e.jsx(E,{type:"button",variant:"outline",onClick:He,children:"Previous"}),e.jsx(E,{type:"button",onClick:Ve,className:"bg-green-600 hover:bg-green-700 text-white",children:"Continue"})]})]}),3===F&&e.jsxs("div",{children:[e.jsx(Ne,{senderName:R,setSenderName:$,senderEmail:V,setSenderEmail:H,senderPhone:q,setSenderPhone:X,senderAddress:G,setSenderAddress:Y,recipientName:z,setRecipientName:W,recipientEmail:K,setRecipientEmail:Z,recipientPhone:Q,setRecipientPhone:ee,recipientAddress:se,setRecipientAddress:ae,pickupCountry:C,pickupPostalCode:g,deliveryCountry:D,deliveryPostalCode:y}),e.jsx(we,{senderName:R,senderAddress:G,pickupPostalCode:g,pickupCountry:C,recipientName:z,recipientAddress:se,deliveryPostalCode:y,deliveryCountry:D}),e.jsxs("div",{className:"flex justify-between gap-4 mt-6",children:[e.jsx(E,{type:"button",variant:"outline",onClick:He,children:"Previous"}),e.jsx(E,{type:"button",onClick:Ve,className:"bg-green-600 hover:bg-green-700 text-white",children:"Continue to Payment"})]})]}),4===F&&e.jsx("div",{children:e.jsx(Pe,{totalPrice:Te(),onPaymentComplete:$e,onSubmit:e=>{T(e)},onCancel:He})})]})]})})]})};export{Ie as default};
